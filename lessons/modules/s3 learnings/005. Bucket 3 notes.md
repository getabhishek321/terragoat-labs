# Bucket: `aws_s3_bucket.financials`

## Purpose

This bucket is intended to store **financial data** likely sensitive PDFs, invoices, audit files, tax documents, 
or internal financial reports.

Although this bucket is **private**, it is still insecure due to missing foundational S3 protections. 
This models a very common real-world scenario:

> *Data is not publicly exposed, but still fails compliance requirements and is at high risk internally.*

---

## Terraform Definition (Simplified)

```hcl
resource "aws_s3_bucket" "financials" {
  # bucket is not encrypted
  # bucket does not have access logs
  # bucket does not have versioning
  bucket        = "${local.resource_prefix.value}-financials"
  acl           = "private"
  force_destroy = true
  tags          = merge(...)
}
```

---

# Deep Dive Into Configuration

## **1. `acl = "private"`, Bucket is not public**

This ensures:

* No anonymous read/write
* Only the AWS account owner has access by default

This is **good**, but extremely misleading because people often assume:

> “If it’s private, it’s secure.”

That is **not true**, many attack paths and compliance issues remain.

---

## **2. Bucket lacks Server-Side Encryption (SSE)**

Missing:

```hcl
server_side_encryption_configuration { ... }
```

This means:

* Data is stored **unencrypted at rest**
* Anyone with access to S3 storage backend could read it
* Violates all major policies:

| Standard              | Requirement                                     |
| --------------------- | ----------------------------------------------- |
| **CIS AWS Benchmark** | Must use SSE-S3 or SSE-KMS                      |
| **PCI-DSS**           | Requires encryption of cardholder data          |
| **HIPAA**             | Requires encryption of PHI                      |
| **GDPR**              | Strongly recommends encryption of personal data |

Financial data usually contains:

* salary info
* billing records
* payment history
* tax records
* transaction logs

All fall under regulated data.

---

## **3. No versioning**

Missing:

```hcl
versioning { enabled = true }
```

Without versioning:

* Overwrites permanently destroy historical data
* Deletes remove files forever
* No rollback for mistakes or ransomware
* No forensic trail of modifications

Real-world incident example:

> A malicious employee overwrites all invoice files → recovery impossible without versioning.

---

## **4. No S3 access logging**

Missing:

```hcl
logging {
  target_bucket = ...
}
```

This means:

* No record of which IAM user/role accessed objects
* No audit trail for compliance officers
* Impossible to investigate suspicious access patterns
* Insider threats can exfiltrate financial reports without leaving traces

For **financial data**, access logs are mandatory from compliance perspective.

---

## **5. `force_destroy = true`**

When combined with no versioning, this is dangerous:

* Running `terraform destroy` wipes financial data instantly
* No protection from accidental removal
* No recovery method

This models how poorly designed IaC pipelines inadvertently destroy production-critical data.

---

# Complete Risk Summary

| Risk                 | Severity     | Why It Matters                                           |
| -------------------- | ------------ | -------------------------------------------------------- |
| No encryption        | **Critical** | Financial records stored in plaintext violate compliance |
| No logging           | High         | No audit capability or forensic trail                    |
| No versioning        | High         | No protection from overwrites, deletes, or ransomware    |
| Private but insecure | Medium       | Prevents public leaks but not internal misuse            |
| `force_destroy`      | Medium       | Accidental deletion risk                                 |

This bucket represents a **high-risk but very common** misconfiguration:

> Not publicly exposed, but still failing every compliance and security baseline.

---

# Learning Takeaway

This resource teaches that **“not public” ≠ secure**.
Most real S3-related audit findings come from:

* lack of encryption
* lack of versioning
* lack of logging
* inconsistent bucket policies
* missing lifecycle controls

TerraformGoat purposely leaves these out so you learn to detect and correct them.

---

If you're ready, say:

> **Next bucket**

We will continue with:

### `aws_s3_bucket.operations`

A versioned but partially misconfigured operational data bucket.
